(()=>{"use strict";var e={855:(e,t,a)=>{var l=a(130),s=a(768),r=a(232);const n={id:"app",class:"min-h-screen bg-gray-50"},i={key:0,class:"bg-white shadow-soft border-b border-gray-100"},o={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},d={class:"flex justify-between h-16"},c={class:"flex items-center"},u={class:"hidden md:ml-6 md:flex md:space-x-8"},m={class:"flex items-center space-x-4"},g={class:"text-sm text-gray-500"},p={key:1,class:"md:hidden bg-white border-b border-gray-200"},v={class:"px-2 pt-2 pb-3 space-y-1"},k={key:2,class:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8"};function x(e,t,a,l,x,h){const f=(0,s.g2)("router-link"),y=(0,s.g2)("router-view");return(0,s.uX)(),(0,s.CE)("div",n,[l.isAuthenticated?((0,s.uX)(),(0,s.CE)("nav",i,[(0,s.Lk)("div",o,[(0,s.Lk)("div",d,[(0,s.Lk)("div",c,[t[1]||(t[1]=(0,s.Lk)("div",{class:"flex-shrink-0"},[(0,s.Lk)("h1",{class:"text-2xl font-bold text-gradient"},"V2R Dashboard")],-1)),(0,s.Lk)("div",u,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.navigation,t=>((0,s.uX)(),(0,s.Wv)(f,{key:t.name,to:t.href,class:(0,r.C4)([e.$route.path===t.href?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium transition-colors duration-200"])},{default:(0,s.k6)(()=>[(0,s.eW)((0,r.v_)(t.name),1)]),_:2},1032,["to","class"]))),128))])]),(0,s.Lk)("div",m,[(0,s.Lk)("div",g,(0,r.v_)(l.currentDate),1),(0,s.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>l.handleLogout&&l.handleLogout(...e)),class:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors duration-200"},[...t[2]||(t[2]=[(0,s.Lk)("svg",{class:"-ml-0.5 mr-2 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,s.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})],-1),(0,s.eW)(" Logout ",-1)])])])])])])):(0,s.Q3)("",!0),l.isAuthenticated?((0,s.uX)(),(0,s.CE)("div",p,[(0,s.Lk)("div",v,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.navigation,t=>((0,s.uX)(),(0,s.Wv)(f,{key:t.name,to:t.href,class:(0,r.C4)([e.$route.path===t.href?"bg-primary-50 border-primary-500 text-primary-700":"border-transparent text-gray-600 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-800","block pl-3 pr-4 py-2 border-l-4 text-base font-medium transition-colors duration-200"])},{default:(0,s.k6)(()=>[(0,s.eW)((0,r.v_)(t.name),1)]),_:2},1032,["to","class"]))),128))])])):(0,s.Q3)("",!0),l.isAuthenticated?((0,s.uX)(),(0,s.CE)("main",k,[(0,s.bF)(y)])):(0,s.Q3)("",!0),l.isAuthenticated?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(y,{key:3}))])}var h=a(144),f=a(387),y=a(401);const L={name:"App",setup(){const e=(0,f.rd)(),t=(0,h.KR)([{name:"Dashboard",href:"/"},{name:"Cheques Detail",href:"/cheques"},{name:"Buildings",href:"/buildings"}]),a=(0,s.EW)(()=>(0,y.A)(new Date,"EEEE, MMMM do, yyyy")),l=(0,s.EW)(()=>"true"===localStorage.getItem("isAuthenticated")),r=()=>{localStorage.removeItem("isAuthenticated"),localStorage.removeItem("user"),e.push("/login")};return{navigation:t,currentDate:a,isAuthenticated:l,handleLogout:r}}};var b=a(241);const w=(0,b.A)(L,[["render",x]]),A=w,C={class:"space-y-6"},B={class:"sm:flex sm:items-center sm:justify-between"},N={class:"mt-4 sm:mt-0"},q=["disabled"],D={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},E={key:1,class:"-ml-1 mr-2 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},I={class:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4"},j={class:"card"},_={class:"flex items-center"},M={class:"ml-5 w-0 flex-1"},O={class:"text-lg font-medium text-gray-900"},F={class:"card"},R={class:"flex items-center"},P={class:"ml-5 w-0 flex-1"},S={class:"text-lg font-medium text-gray-900"},V={class:"card"},X={class:"flex items-center"},K={class:"ml-5 w-0 flex-1"},W={class:"text-lg font-medium text-gray-900"},z={class:"card"},H={class:"flex items-center"},T={class:"ml-5 w-0 flex-1"},U={class:"text-lg font-medium text-gray-900"},$={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},J={class:"card"},Q={class:"h-64"},G={ref:"chequesChart"},Y={class:"card"},Z={class:"h-64"},ee={ref:"buildingsChart"},te={class:"card"},ae={class:"overflow-x-auto"},le={class:"min-w-full divide-y divide-gray-200"},se={class:"bg-white divide-y divide-gray-200"},re={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},ne={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},ie={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},oe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},de={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"};function ce(e,t,a,l,n,i){return(0,s.uX)(),(0,s.CE)("div",C,[(0,s.Lk)("div",B,[t[4]||(t[4]=(0,s.Lk)("div",null,[(0,s.Lk)("h1",{class:"text-3xl font-bold text-gray-900"},"Dashboard Overview"),(0,s.Lk)("p",{class:"mt-2 text-sm text-gray-700"}," Real-time overview of your buildings, apartments, and cheques ")],-1)),(0,s.Lk)("div",N,[(0,s.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>l.refreshData&&l.refreshData(...e)),disabled:l.loading,class:"btn-primary inline-flex items-center"},[l.loading?((0,s.uX)(),(0,s.CE)("svg",D,[...t[1]||(t[1]=[(0,s.Lk)("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),(0,s.Lk)("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):((0,s.uX)(),(0,s.CE)("svg",E,[...t[2]||(t[2]=[(0,s.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])])),t[3]||(t[3]=(0,s.eW)(" Refresh ",-1))],8,q)])]),(0,s.Lk)("div",I,[(0,s.Lk)("div",j,[(0,s.Lk)("div",_,[t[6]||(t[6]=(0,s.Lk)("div",{class:"flex-shrink-0"},[(0,s.Lk)("div",{class:"w-8 h-8 bg-primary-100 rounded-lg flex items-center justify-center"},[(0,s.Lk)("svg",{class:"w-5 h-5 text-primary-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,s.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})])])],-1)),(0,s.Lk)("div",M,[(0,s.Lk)("dl",null,[t[5]||(t[5]=(0,s.Lk)("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Total Buildings",-1)),(0,s.Lk)("dd",O,(0,r.v_)(l.summary.totalBuildings),1)])])])]),(0,s.Lk)("div",F,[(0,s.Lk)("div",R,[t[8]||(t[8]=(0,s.Fv)('<div class="flex-shrink-0"><div class="w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center"><svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5v4m8-4v4M8 11v4m8-4v4"></path></svg></div></div>',1)),(0,s.Lk)("div",P,[(0,s.Lk)("dl",null,[t[7]||(t[7]=(0,s.Lk)("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Total Apartments",-1)),(0,s.Lk)("dd",S,(0,r.v_)(l.summary.totalApartments),1)])])])]),(0,s.Lk)("div",V,[(0,s.Lk)("div",X,[t[10]||(t[10]=(0,s.Lk)("div",{class:"flex-shrink-0"},[(0,s.Lk)("div",{class:"w-8 h-8 bg-yellow-100 rounded-lg flex items-center justify-center"},[(0,s.Lk)("svg",{class:"w-5 h-5 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,s.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])])],-1)),(0,s.Lk)("div",K,[(0,s.Lk)("dl",null,[t[9]||(t[9]=(0,s.Lk)("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Total Cheques",-1)),(0,s.Lk)("dd",W,(0,r.v_)(l.summary.totalCheques),1)])])])]),(0,s.Lk)("div",z,[(0,s.Lk)("div",H,[t[12]||(t[12]=(0,s.Lk)("div",{class:"flex-shrink-0"},[(0,s.Lk)("div",{class:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center"},[(0,s.Lk)("svg",{class:"w-5 h-5 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,s.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})])])],-1)),(0,s.Lk)("div",T,[(0,s.Lk)("dl",null,[t[11]||(t[11]=(0,s.Lk)("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Total Amount",-1)),(0,s.Lk)("dd",U,(0,r.v_)(l.formatCurrency(l.summary.totalAmount)),1)])])])])]),(0,s.Lk)("div",$,[(0,s.Lk)("div",J,[t[13]||(t[13]=(0,s.Lk)("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Cheques by Month",-1)),(0,s.Lk)("div",Q,[(0,s.Lk)("canvas",G,null,512)])]),(0,s.Lk)("div",Y,[t[14]||(t[14]=(0,s.Lk)("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Buildings Overview",-1)),(0,s.Lk)("div",Z,[(0,s.Lk)("canvas",ee,null,512)])])]),(0,s.Lk)("div",te,[t[16]||(t[16]=(0,s.Lk)("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Recent Cheques",-1)),(0,s.Lk)("div",ae,[(0,s.Lk)("table",le,[t[15]||(t[15]=(0,s.Lk)("thead",{class:"bg-gray-50"},[(0,s.Lk)("tr",null,[(0,s.Lk)("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date"),(0,s.Lk)("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Building"),(0,s.Lk)("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Apartment"),(0,s.Lk)("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Cheque No"),(0,s.Lk)("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Amount")])],-1)),(0,s.Lk)("tbody",se,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.recentCheques,e=>((0,s.uX)(),(0,s.CE)("tr",{key:e.ChequeID,class:"hover:bg-gray-50"},[(0,s.Lk)("td",re,(0,r.v_)(l.formatDate(e.ChequeDate)),1),(0,s.Lk)("td",ne,(0,r.v_)(e.BuildingName),1),(0,s.Lk)("td",ie,(0,r.v_)(e.ApartmentName),1),(0,s.Lk)("td",oe,(0,r.v_)(e.ChequeNo),1),(0,s.Lk)("td",de,(0,r.v_)(l.formatCurrency(e.Amount)),1)]))),128))])])])])])}var ue=a(52),me=a(373),ge=a(244);ue.t1.register(...ue.$L);const pe={name:"Dashboard",setup(){const e=(0,h.KR)(!1),t=(0,h.KR)({totalBuildings:0,totalApartments:0,totalCheques:0,totalAmount:0}),a=(0,h.KR)([]),l=(0,h.KR)([]),r=(0,h.KR)([]),n=(0,h.KR)([]),i=(0,h.KR)(null),o=(0,h.KR)(null),d=async()=>{try{const[e,a,s,i]=await Promise.all([me.A.get("/api/buildings"),me.A.get("/api/apartments"),me.A.get("/api/cheques/detail"),me.A.get("/api/cheques/summary")]);l.value=e.data,r.value=a.data,n.value=s.data,console.log("Dashboard - Buildings data:",e.data),console.log("Dashboard - Apartments data:",a.data),console.log("Dashboard - Cheques data:",s.data),console.log("Dashboard - Summary data:",i.data);let o=i.data?.NumberOfCheques||i.data?.numberOfCheques||0,d=i.data?.TotalAmount||i.data?.totalAmount||0;!o&&s.data.length>0&&(o=s.data.length,d=s.data.reduce((e,t)=>e+(t.Amount||0),0),console.log("Dashboard - Calculated from cheques:",{totalCheques:o,totalAmount:d})),t.value={totalBuildings:e.data.length,totalApartments:a.data.length,totalCheques:o,totalAmount:d}}catch(e){console.error("Error fetching summary:",e)}},c=async()=>{try{const e=await me.A.get("/api/cheques/detail");a.value=e.data.slice(0,10),console.log("Dashboard - Recent cheques:",a.value)}catch(e){console.error("Error fetching recent cheques:",e),a.value=[]}},u=async()=>{if(await(0,s.dY)(),i.value){const e=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],t=new Array(12).fill(0);n.value.forEach(e=>{if(e.ChequeDate)try{const a=new Date(e.ChequeDate),l=a.getMonth();t[l]++}catch(a){console.log("Could not parse date:",e.ChequeDate)}}),new ue.t1(i.value,{type:"line",data:{labels:e,datasets:[{label:"Cheques Count",data:t,borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.4,fill:!0}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(e){return`Cheques: ${e.parsed.y}`}}}},scales:{y:{beginAtZero:!0,ticks:{stepSize:1}},x:{grid:{display:!1}}}}})}if(o.value){const e=l.value.map(e=>{const t=r.value.filter(t=>t.BuildingName===e.BuildingName||t.buildingName===e.BuildingName),a=n.value.filter(t=>t.BuildingName===e.BuildingName||t.buildingName===e.BuildingName),l=a.reduce((e,t)=>e+(t.Amount||0),0);return{name:e.BuildingName,apartments:t.length,cheques:a.length,amount:l}}),t=e.sort((e,t)=>t.amount-e.amount).slice(0,5);new ue.t1(o.value,{type:"doughnut",data:{labels:t.map(e=>e.name),datasets:[{data:t.map(e=>e.amount),backgroundColor:["rgb(59, 130, 246)","rgb(16, 185, 129)","rgb(245, 158, 11)","rgb(239, 68, 68)","rgb(139, 92, 246)"]}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{usePointStyle:!0,padding:20}},tooltip:{callbacks:{label:function(e){const a=t[e.dataIndex];return[`Building: ${a.name}`,`Total Amount: $${a.amount.toLocaleString()}`,`Apartments: ${a.apartments}`,`Cheques: ${a.cheques}`]}}}}}})}},m=async()=>{e.value=!0;try{await Promise.all([d(),c()]),await u()}finally{e.value=!1}},g=e=>new Intl.NumberFormat("en-AE",{style:"currency",currency:"AED"}).format(e||0),p=e=>{try{return(0,y.A)((0,ge.A)(e),"MMM dd, yyyy")}catch{return e}};return(0,s.sV)(async()=>{await m()}),{loading:e,summary:t,recentCheques:a,buildings:l,apartments:r,cheques:n,chequesChart:i,buildingsChart:o,refreshData:m,formatCurrency:g,formatDate:p}}},ve=(0,b.A)(pe,[["render",ce]]),ke=ve,xe={class:"space-y-6"},he={class:"sm:flex sm:items-center sm:justify-between"},fe={class:"mt-4 sm:mt-0"},ye=["disabled"],Le={class:"card"},be={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},we=["value"],Ae=["disabled"],Ce=["value"],Be={class:"mt-4 flex justify-end"},Ne=["disabled"],qe={class:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-3"},De={class:"card"},Ee={class:"flex items-center"},Ie={class:"ml-5 w-0 flex-1"},je={class:"text-lg font-medium text-gray-900"},_e={class:"card"},Me={class:"flex items-center"},Oe={class:"ml-5 w-0 flex-1"},Fe={class:"text-lg font-medium text-gray-900"},Re={class:"card"},Pe={class:"flex items-center"},Se={class:"ml-5 w-0 flex-1"},Ve={class:"text-lg font-medium text-gray-900"},Xe={class:"card"},Ke={class:"sm:flex sm:items-center sm:justify-between mb-4"},We={class:"mt-3 sm:mt-0 sm:ml-4"},ze={class:"flex rounded-md shadow-sm"},He={class:"overflow-x-auto"},Te={class:"min-w-full divide-y divide-gray-200"},Ue={class:"bg-white divide-y divide-gray-200"},$e={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Je={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Qe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Ge={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Ye={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Ze={class:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6"},et={class:"flex-1 flex justify-between sm:hidden"},tt=["disabled"],at=["disabled"],lt={class:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between"},st={class:"text-sm text-gray-700"},rt={class:"font-medium"},nt={class:"font-medium"},it={class:"font-medium"},ot={class:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px"},dt=["disabled"],ct=["disabled"];function ut(e,t,a,n,i,o){return(0,s.uX)(),(0,s.CE)("div",xe,[(0,s.Lk)("div",he,[t[17]||(t[17]=(0,s.Lk)("div",null,[(0,s.Lk)("h1",{class:"text-3xl font-bold text-gray-900"},"Cheques Detail"),(0,s.Lk)("p",{class:"mt-2 text-sm text-gray-700"}," View and filter detailed cheque information ")],-1)),(0,s.Lk)("div",fe,[(0,s.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>n.exportData&&n.exportData(...e)),disabled:n.loading,class:"btn-secondary inline-flex items-center"},[...t[16]||(t[16]=[(0,s.Lk)("svg",{class:"-ml-1 mr-2 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,s.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),(0,s.eW)(" Export ",-1)])],8,ye)])]),(0,s.Lk)("div",Le,[t[24]||(t[24]=(0,s.Lk)("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Filters",-1)),(0,s.Lk)("div",be,[(0,s.Lk)("div",null,[t[18]||(t[18]=(0,s.Lk)("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"From Date",-1)),(0,s.bo)((0,s.Lk)("input",{type:"date","onUpdate:modelValue":t[1]||(t[1]=e=>n.filters.fromDate=e),class:"input-field",onChange:t[2]||(t[2]=(...e)=>n.applyFilters&&n.applyFilters(...e))},null,544),[[l.Jo,n.filters.fromDate]])]),(0,s.Lk)("div",null,[t[19]||(t[19]=(0,s.Lk)("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"To Date",-1)),(0,s.bo)((0,s.Lk)("input",{type:"date","onUpdate:modelValue":t[3]||(t[3]=e=>n.filters.toDate=e),class:"input-field",onChange:t[4]||(t[4]=(...e)=>n.applyFilters&&n.applyFilters(...e))},null,544),[[l.Jo,n.filters.toDate]])]),(0,s.Lk)("div",null,[t[21]||(t[21]=(0,s.Lk)("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Building",-1)),(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[5]||(t[5]=e=>n.filters.buildingName=e),class:"input-field",onChange:t[6]||(t[6]=(...e)=>n.applyFilters&&n.applyFilters(...e))},[t[20]||(t[20]=(0,s.Lk)("option",{value:""},"All Buildings",-1)),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.buildings,e=>((0,s.uX)(),(0,s.CE)("option",{key:e.BuildingID,value:e.BuildingName},(0,r.v_)(e.BuildingName),9,we))),128))],544),[[l.u1,n.filters.buildingName]])]),(0,s.Lk)("div",null,[t[23]||(t[23]=(0,s.Lk)("label",{class:"text-sm font-medium text-gray-700 mb-2"},"Apartment",-1)),(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[7]||(t[7]=e=>n.filters.apartmentName=e),class:"input-field",onChange:t[8]||(t[8]=(...e)=>n.applyFilters&&n.applyFilters(...e)),disabled:!n.filters.buildingName},[t[22]||(t[22]=(0,s.Lk)("option",{value:""},"All Apartments",-1)),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.filteredApartments,e=>((0,s.uX)(),(0,s.CE)("option",{key:e.ApartmentID,value:e.ApartmentName},(0,r.v_)(e.ApartmentName),9,Ce))),128))],40,Ae),[[l.u1,n.filters.apartmentName]])])]),(0,s.Lk)("div",Be,[(0,s.Lk)("button",{onClick:t[9]||(t[9]=(...e)=>n.clearFilters&&n.clearFilters(...e)),class:"btn-secondary mr-2"}," Clear Filters "),(0,s.Lk)("button",{onClick:t[10]||(t[10]=(...e)=>n.applyFilters&&n.applyFilters(...e)),disabled:n.loading,class:"btn-primary"}," Apply Filters ",8,Ne)])]),(0,s.Lk)("div",qe,[(0,s.Lk)("div",De,[(0,s.Lk)("div",Ee,[t[26]||(t[26]=(0,s.Lk)("div",{class:"flex-shrink-0"},[(0,s.Lk)("div",{class:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center"},[(0,s.Lk)("svg",{class:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,s.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])])],-1)),(0,s.Lk)("div",Ie,[(0,s.Lk)("dl",null,[t[25]||(t[25]=(0,s.Lk)("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Total Cheques",-1)),(0,s.Lk)("dd",je,(0,r.v_)(n.summary.NumberOfCheques||n.summary.numberOfCheques||n.cheques.length||0),1)])])])]),(0,s.Lk)("div",_e,[(0,s.Lk)("div",Me,[t[28]||(t[28]=(0,s.Lk)("div",{class:"flex-shrink-0"},[(0,s.Lk)("div",{class:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center"},[(0,s.Lk)("svg",{class:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,s.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})])])],-1)),(0,s.Lk)("div",Oe,[(0,s.Lk)("dl",null,[t[27]||(t[27]=(0,s.Lk)("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Total Amount",-1)),(0,s.Lk)("dd",Fe,(0,r.v_)(n.formatCurrency(n.summary.TotalAmount||n.summary.totalAmount||(n.cheques.length>0?n.cheques.reduce((e,t)=>e+(t.Amount||0),0):0))),1)])])])]),(0,s.Lk)("div",Re,[(0,s.Lk)("div",Pe,[t[30]||(t[30]=(0,s.Lk)("div",{class:"flex-shrink-0"},[(0,s.Lk)("div",{class:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center"},[(0,s.Lk)("svg",{class:"w-5 h-5 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,s.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})])])],-1)),(0,s.Lk)("div",Se,[(0,s.Lk)("dl",null,[t[29]||(t[29]=(0,s.Lk)("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Average Amount",-1)),(0,s.Lk)("dd",Ve,(0,r.v_)(n.formatCurrency(n.averageAmount)),1)])])])])]),(0,s.Lk)("div",Xe,[(0,s.Lk)("div",Ke,[t[32]||(t[32]=(0,s.Lk)("h3",{class:"text-lg font-medium text-gray-900"},"Cheques Data",-1)),(0,s.Lk)("div",We,[(0,s.Lk)("div",ze,[(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":t[11]||(t[11]=e=>n.searchTerm=e),placeholder:"Search cheques...",class:"input-field rounded-r-none"},null,512),[[l.Jo,n.searchTerm]]),t[31]||(t[31]=(0,s.Lk)("button",{class:"btn-primary rounded-l-none"},[(0,s.Lk)("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,s.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1))])])]),(0,s.Lk)("div",He,[(0,s.Lk)("table",Te,[t[34]||(t[34]=(0,s.Lk)("thead",{class:"bg-gray-50"},[(0,s.Lk)("tr",null,[(0,s.Lk)("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date"),(0,s.Lk)("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Building"),(0,s.Lk)("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Apartment"),(0,s.Lk)("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Cheque No"),(0,s.Lk)("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Amount"),(0,s.Lk)("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status")])],-1)),(0,s.Lk)("tbody",Ue,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.filteredCheques,e=>((0,s.uX)(),(0,s.CE)("tr",{key:e.ChequeID,class:"hover:bg-gray-50"},[(0,s.Lk)("td",$e,(0,r.v_)(n.formatDate(e.ChequeDate)),1),(0,s.Lk)("td",Je,(0,r.v_)(e.BuildingName),1),(0,s.Lk)("td",Qe,(0,r.v_)(e.ApartmentName),1),(0,s.Lk)("td",Ge,(0,r.v_)(e.ChequeNo),1),(0,s.Lk)("td",Ye,(0,r.v_)(n.formatCurrency(e.Amount)),1),t[33]||(t[33]=(0,s.Lk)("td",{class:"px-6 py-4 whitespace-nowrap"},[(0,s.Lk)("span",{class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"}," Active ")],-1))]))),128))])])]),(0,s.Lk)("div",Ze,[(0,s.Lk)("div",et,[(0,s.Lk)("button",{onClick:t[12]||(t[12]=(...e)=>n.previousPage&&n.previousPage(...e)),disabled:1===n.currentPage,class:"btn-secondary"}," Previous ",8,tt),(0,s.Lk)("button",{onClick:t[13]||(t[13]=(...e)=>n.nextPage&&n.nextPage(...e)),disabled:n.currentPage===n.totalPages,class:"btn-primary"}," Next ",8,at)]),(0,s.Lk)("div",lt,[(0,s.Lk)("div",null,[(0,s.Lk)("p",st,[t[35]||(t[35]=(0,s.eW)(" Showing ",-1)),(0,s.Lk)("span",rt,(0,r.v_)(n.startIndex+1),1),t[36]||(t[36]=(0,s.eW)(" to ",-1)),(0,s.Lk)("span",nt,(0,r.v_)(n.endIndex),1),t[37]||(t[37]=(0,s.eW)(" of ",-1)),(0,s.Lk)("span",it,(0,r.v_)(n.totalCheques.length),1),t[38]||(t[38]=(0,s.eW)(" results ",-1))])]),(0,s.Lk)("div",null,[(0,s.Lk)("nav",ot,[(0,s.Lk)("button",{onClick:t[14]||(t[14]=(...e)=>n.previousPage&&n.previousPage(...e)),disabled:1===n.currentPage,class:"btn-secondary rounded-l-md"}," Previous ",8,dt),(0,s.Lk)("button",{onClick:t[15]||(t[15]=(...e)=>n.nextPage&&n.nextPage(...e)),disabled:n.currentPage===n.totalPages,class:"btn-primary rounded-r-md"}," Next ",8,ct)])])])])])])}const mt={name:"ChequesDetail",setup(){const e=(0,h.KR)(!1),t=(0,h.KR)([]),a=(0,h.KR)([]),l=(0,h.KR)([]),r=(0,h.KR)({}),n=(0,h.KR)({fromDate:"",toDate:"",buildingName:"",apartmentName:""}),i=(0,h.KR)(""),o=(0,h.KR)(1),d=20,c=(0,s.EW)(()=>n.value.buildingName?l.value.filter(e=>e.BuildingName===n.value.buildingName):[]),u=(0,s.EW)(()=>{let e=t.value;if(i.value){const t=i.value.toLowerCase();e=e.filter(e=>e.ChequeNo?.toLowerCase().includes(t)||e.BuildingName?.toLowerCase().includes(t)||e.ApartmentName?.toLowerCase().includes(t))}return e}),m=(0,s.EW)(()=>u.value),g=(0,s.EW)(()=>Math.ceil(m.value.length/d)),p=(0,s.EW)(()=>(o.value-1)*d),v=(0,s.EW)(()=>Math.min(p.value+d,m.value.length)),k=(0,s.EW)(()=>{console.log("Summary data:",r.value),console.log("Cheques data length:",t.value.length);let e=r.value?.NumberOfCheques||r.value?.numberOfCheques||0,a=r.value?.TotalAmount||r.value?.totalAmount||0;return!e&&t.value.length>0&&(e=t.value.length,a=t.value.reduce((e,t)=>e+(t.Amount||0),0),console.log("Calculated from cheques:",{numberOfCheques:e,totalAmount:a})),e&&0!==e?a/e:0}),x=async()=>{e.value=!0;try{const[e,s,n,i]=await Promise.all([me.A.get("/api/buildings"),me.A.get("/api/apartments"),me.A.get("/api/cheques/detail"),me.A.get("/api/cheques/summary")]);a.value=e.data,l.value=s.data,t.value=n.data,r.value=i.data,console.log("Buildings data:",e.data),console.log("Apartments data:",s.data),console.log("Cheques data:",n.data),console.log("Summary data:",i.data)}catch(s){console.error("Error fetching data:",s)}finally{e.value=!1}},f=async()=>{e.value=!0;try{const e={};n.value.fromDate&&(e.fromDate=n.value.fromDate),n.value.toDate&&(e.toDate=n.value.toDate),n.value.buildingName&&(e.buildingName=n.value.buildingName),n.value.apartmentName&&(e.apartmentName=n.value.apartmentName);const[a,l]=await Promise.all([me.A.get("/api/cheques/detail",{params:e}),me.A.get("/api/cheques/summary",{params:e})]);t.value=a.data,r.value=l.data,o.value=1}catch(a){console.error("Error applying filters:",a)}finally{e.value=!1}},L=()=>{n.value={fromDate:"",toDate:"",buildingName:"",apartmentName:""},i.value="",x()},b=()=>{o.value>1&&o.value--},w=()=>{o.value<g.value&&o.value++},A=()=>{const e=C(u.value),t=new Blob([e],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a");a.href=URL.createObjectURL(t),a.download="cheques_export.csv",a.click()},C=e=>{const t=["Date","Building","Apartment","Cheque No","Amount"],a=e.map(e=>[N(e.ChequeDate),e.BuildingName,e.ApartmentName,e.ChequeNo,e.Amount]);return[t,...a].map(e=>e.map(e=>`"${e}"`).join(",")).join("\n")},B=e=>new Intl.NumberFormat("en-AE",{style:"currency",currency:"AED"}).format(e||0),N=e=>{try{return(0,y.A)((0,ge.A)(e),"MMM dd, yyyy")}catch{return e}};return(0,s.sV)(()=>{x()}),(0,s.wB)(n,()=>{n.value.buildingName&&n.value.apartmentName&&(n.value.apartmentName="")}),{loading:e,cheques:t,buildings:a,apartments:l,summary:r,filters:n,searchTerm:i,currentPage:o,totalPages:g,startIndex:p,endIndex:v,averageAmount:k,filteredApartments:c,filteredCheques:u,totalCheques:m,applyFilters:f,clearFilters:L,previousPage:b,nextPage:w,exportData:A,formatCurrency:B,formatDate:N}}},gt=(0,b.A)(mt,[["render",ut]]),pt=gt,vt={class:"space-y-6"},kt={class:"sm:flex sm:items-center sm:justify-between"},xt={class:"mt-4 sm:mt-0"},ht=["disabled"],ft={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},yt={key:1,class:"-ml-1 mr-2 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Lt={class:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4"},bt={class:"card"},wt={class:"flex items-center"},At={class:"ml-5 w-0 flex-1"},Ct={class:"text-lg font-medium text-gray-900"},Bt={class:"card"},Nt={class:"flex items-center"},qt={class:"ml-5 w-0 flex-1"},Dt={class:"text-lg font-medium text-gray-900"},Et={class:"card"},It={class:"flex items-center"},jt={class:"ml-5 w-0 flex-1"},_t={class:"text-lg font-medium text-gray-900"},Mt={class:"card"},Ot={class:"flex items-center"},Ft={class:"ml-5 w-0 flex-1"},Rt={class:"text-lg font-medium text-gray-900"},Pt={class:"grid grid-cols-1 gap-6 lg:grid-cols-2 xl:grid-cols-3"},St=["onClick"],Vt={class:"flex items-center justify-between mb-4"},Xt={class:"flex items-center"},Kt={class:"ml-3"},Wt={class:"text-lg font-medium text-gray-900"},zt={class:"text-right"},Ht={class:"text-2xl font-bold text-primary-600"},Tt={class:"border-t border-gray-100 pt-4"},Ut={class:"grid grid-cols-2 gap-4 text-sm"},$t={class:"ml-2 font-medium text-gray-900"},Jt={class:"ml-2 font-medium text-gray-900"},Qt={class:"mt-4 pt-4 border-t border-gray-100"},Gt={class:"flex items-center justify-between mb-2"},Yt={class:"flex items-center"},Zt={class:"w-16 bg-gray-200 rounded-full h-2 mr-2"},ea={class:"text-sm font-medium text-gray-900"},ta={class:"grid grid-cols-2 gap-2 text-xs text-gray-500"},aa={class:"text-green-600 font-medium"},la={class:"text-red-600 font-medium"},sa={key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},ra={class:"relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white"},na={class:"mt-3"},ia={class:"flex items-center justify-between mb-4"},oa={class:"text-lg font-medium text-gray-900"},da={class:"space-y-4"},ca={class:"grid grid-cols-2 gap-4"},ua={class:"mt-1 text-sm text-gray-900"},ma={class:"mt-1 text-sm text-gray-900"},ga={class:"border-t border-gray-200 pt-4"},pa={class:"max-h-60 overflow-y-auto"},va={class:"text-sm font-medium text-gray-900"},ka={class:"ml-2 text-xs text-gray-500"},xa={class:"text-xs text-gray-500"},ha={class:"border-t border-gray-200 pt-4"},fa={class:"grid grid-cols-2 gap-4 text-center mb-4"},ya={class:"text-2xl font-bold text-green-600"},La={class:"text-2xl font-bold text-red-600"},ba={class:"text-center"},wa={class:"text-3xl font-bold text-primary-600"},Aa={class:"border-t border-gray-200 pt-4"},Ca={class:"grid grid-cols-3 gap-4 text-center"},Ba={class:"text-2xl font-bold text-primary-600"},Na={class:"text-2xl font-bold text-green-600"},qa={class:"text-2xl font-bold text-purple-600"};function Da(e,t,a,l,n,i){return(0,s.uX)(),(0,s.CE)("div",vt,[(0,s.Lk)("div",kt,[t[5]||(t[5]=(0,s.Lk)("div",null,[(0,s.Lk)("h1",{class:"text-3xl font-bold text-gray-900"},"Buildings Management"),(0,s.Lk)("p",{class:"mt-2 text-sm text-gray-700"}," Overview and management of all buildings ")],-1)),(0,s.Lk)("div",xt,[(0,s.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>l.refreshData&&l.refreshData(...e)),disabled:l.loading,class:"btn-primary inline-flex items-center"},[l.loading?((0,s.uX)(),(0,s.CE)("svg",ft,[...t[2]||(t[2]=[(0,s.Lk)("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),(0,s.Lk)("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):((0,s.uX)(),(0,s.CE)("svg",yt,[...t[3]||(t[3]=[(0,s.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])])),t[4]||(t[4]=(0,s.eW)(" Refresh ",-1))],8,ht)])]),(0,s.Lk)("div",Lt,[(0,s.Lk)("div",bt,[(0,s.Lk)("div",wt,[t[7]||(t[7]=(0,s.Lk)("div",{class:"flex-shrink-0"},[(0,s.Lk)("div",{class:"w-8 h-8 bg-primary-100 rounded-lg flex items-center justify-center"},[(0,s.Lk)("svg",{class:"w-5 h-5 text-primary-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,s.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})])])],-1)),(0,s.Lk)("div",At,[(0,s.Lk)("dl",null,[t[6]||(t[6]=(0,s.Lk)("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Total Buildings",-1)),(0,s.Lk)("dd",Ct,(0,r.v_)(l.buildings.length),1)])])])]),(0,s.Lk)("div",Bt,[(0,s.Lk)("div",Nt,[t[9]||(t[9]=(0,s.Fv)('<div class="flex-shrink-0"><div class="w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center"><svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5v4m8-4v4M8 11v4m8-4v4"></path></svg></div></div>',1)),(0,s.Lk)("div",qt,[(0,s.Lk)("dl",null,[t[8]||(t[8]=(0,s.Lk)("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Total Apartments",-1)),(0,s.Lk)("dd",Dt,(0,r.v_)(l.totalApartments),1)])])])]),(0,s.Lk)("div",Et,[(0,s.Lk)("div",It,[t[11]||(t[11]=(0,s.Lk)("div",{class:"flex-shrink-0"},[(0,s.Lk)("div",{class:"w-8 h-8 bg-yellow-100 rounded-lg flex items-center justify-center"},[(0,s.Lk)("svg",{class:"w-5 h-5 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,s.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])])],-1)),(0,s.Lk)("div",jt,[(0,s.Lk)("dl",null,[t[10]||(t[10]=(0,s.Lk)("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Total Cheques",-1)),(0,s.Lk)("dd",_t,(0,r.v_)(l.totalCheques),1)])])])]),(0,s.Lk)("div",Mt,[(0,s.Lk)("div",Ot,[t[13]||(t[13]=(0,s.Lk)("div",{class:"flex-shrink-0"},[(0,s.Lk)("div",{class:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center"},[(0,s.Lk)("svg",{class:"w-5 h-5 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,s.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})])])],-1)),(0,s.Lk)("div",Ft,[(0,s.Lk)("dl",null,[t[12]||(t[12]=(0,s.Lk)("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Total Amount",-1)),(0,s.Lk)("dd",Rt,(0,r.v_)(l.formatCurrency(l.totalAmount)),1)])])])])]),(0,s.Lk)("div",Pt,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.buildings,e=>((0,s.uX)(),(0,s.CE)("div",{key:e.BuildingID,class:"card hover:shadow-lg transition-shadow duration-200 cursor-pointer",onClick:t=>l.selectBuilding(e)},[(0,s.Lk)("div",Vt,[(0,s.Lk)("div",Xt,[t[14]||(t[14]=(0,s.Lk)("div",{class:"w-10 h-10 bg-primary-100 rounded-lg flex items-center justify-center"},[(0,s.Lk)("svg",{class:"w-6 h-6 text-primary-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,s.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})])],-1)),(0,s.Lk)("div",Kt,[(0,s.Lk)("h3",Wt,(0,r.v_)(e.BuildingName),1)])]),(0,s.Lk)("div",zt,[(0,s.Lk)("div",Ht,(0,r.v_)(l.getBuildingStats(e.BuildingName).apartments),1),t[15]||(t[15]=(0,s.Lk)("div",{class:"text-xs text-gray-500"},"Apartments",-1))])]),(0,s.Lk)("div",Tt,[(0,s.Lk)("div",Ut,[(0,s.Lk)("div",null,[t[16]||(t[16]=(0,s.Lk)("span",{class:"text-gray-500"},"Cheques:",-1)),(0,s.Lk)("span",$t,(0,r.v_)(l.getBuildingStats(e.BuildingName).cheques),1)]),(0,s.Lk)("div",null,[t[17]||(t[17]=(0,s.Lk)("span",{class:"text-gray-500"},"Amount:",-1)),(0,s.Lk)("span",Jt,(0,r.v_)(l.formatCurrency(l.getBuildingStats(e.BuildingName).amount)),1)])])]),(0,s.Lk)("div",Qt,[(0,s.Lk)("div",Gt,[t[18]||(t[18]=(0,s.Lk)("span",{class:"text-sm text-gray-500"},"Occupancy Rate",-1)),(0,s.Lk)("div",Yt,[(0,s.Lk)("div",Zt,[(0,s.Lk)("div",{class:"bg-primary-600 h-2 rounded-full",style:(0,r.Tr)({width:l.getOccupancyRate(e.BuildingName)+"%"})},null,4)]),(0,s.Lk)("span",ea,(0,r.v_)(l.getOccupancyRate(e.BuildingName))+"% ",1)])]),(0,s.Lk)("div",ta,[(0,s.Lk)("div",null,[(0,s.Lk)("span",aa,(0,r.v_)(l.getOccupancyDetails(e.BuildingName).occupied),1),t[19]||(t[19]=(0,s.eW)(" occupied ",-1))]),(0,s.Lk)("div",null,[(0,s.Lk)("span",la,(0,r.v_)(l.getOccupancyDetails(e.BuildingName).vacant),1),t[20]||(t[20]=(0,s.eW)(" vacant ",-1))])])])],8,St))),128))]),l.selectedBuilding?((0,s.uX)(),(0,s.CE)("div",sa,[(0,s.Lk)("div",ra,[(0,s.Lk)("div",na,[(0,s.Lk)("div",ia,[(0,s.Lk)("h3",oa,(0,r.v_)(l.selectedBuilding.BuildingName)+" Details ",1),(0,s.Lk)("button",{onClick:t[1]||(t[1]=e=>l.selectedBuilding=null),class:"text-gray-400 hover:text-gray-600"},[...t[21]||(t[21]=[(0,s.Lk)("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,s.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),(0,s.Lk)("div",da,[(0,s.Lk)("div",ca,[(0,s.Lk)("div",null,[t[22]||(t[22]=(0,s.Lk)("label",{class:"block text-sm font-medium text-gray-700"},"Building Name",-1)),(0,s.Lk)("p",ua,(0,r.v_)(l.selectedBuilding.BuildingName),1)]),(0,s.Lk)("div",null,[t[23]||(t[23]=(0,s.Lk)("label",{class:"block text-sm font-medium text-gray-700"},"Building Number",-1)),(0,s.Lk)("p",ma,(0,r.v_)(l.selectedBuilding.BuildingNumber||"N/A"),1)])]),(0,s.Lk)("div",ga,[t[24]||(t[24]=(0,s.Lk)("h4",{class:"text-md font-medium text-gray-900 mb-3"},"Apartment List",-1)),(0,s.Lk)("div",pa,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.getBuildingApartments(l.selectedBuilding.BuildingName),e=>((0,s.uX)(),(0,s.CE)("div",{key:e.ApartmentID,class:"flex items-center justify-between py-2 border-b border-gray-100 last:border-b-0"},[(0,s.Lk)("div",null,[(0,s.Lk)("span",va,(0,r.v_)(e.ApartmentName),1),(0,s.Lk)("span",ka,"Floor "+(0,r.v_)(e.FloorNumber),1)]),(0,s.Lk)("span",xa,(0,r.v_)(e.ApartmentNumber||"N/A"),1)]))),128))])]),(0,s.Lk)("div",ha,[t[28]||(t[28]=(0,s.Lk)("h4",{class:"text-md font-medium text-gray-900 mb-3"},"Occupancy Summary",-1)),(0,s.Lk)("div",fa,[(0,s.Lk)("div",null,[(0,s.Lk)("div",ya,(0,r.v_)(l.getOccupancyDetails(l.selectedBuilding.BuildingName).occupied),1),t[25]||(t[25]=(0,s.Lk)("div",{class:"text-xs text-gray-500"},"Occupied",-1))]),(0,s.Lk)("div",null,[(0,s.Lk)("div",La,(0,r.v_)(l.getOccupancyDetails(l.selectedBuilding.BuildingName).vacant),1),t[26]||(t[26]=(0,s.Lk)("div",{class:"text-xs text-gray-500"},"Vacant",-1))])]),(0,s.Lk)("div",ba,[(0,s.Lk)("div",wa,(0,r.v_)(l.getOccupancyDetails(l.selectedBuilding.BuildingName).rate)+"% ",1),t[27]||(t[27]=(0,s.Lk)("div",{class:"text-sm text-gray-500"},"Overall Occupancy Rate",-1))])]),(0,s.Lk)("div",Aa,[t[32]||(t[32]=(0,s.Lk)("h4",{class:"text-md font-medium text-gray-900 mb-3"},"Financial Summary",-1)),(0,s.Lk)("div",Ca,[(0,s.Lk)("div",null,[(0,s.Lk)("div",Ba,(0,r.v_)(l.getBuildingStats(l.selectedBuilding.BuildingName).apartments),1),t[29]||(t[29]=(0,s.Lk)("div",{class:"text-xs text-gray-500"},"Apartments",-1))]),(0,s.Lk)("div",null,[(0,s.Lk)("div",Na,(0,r.v_)(l.getBuildingStats(l.selectedBuilding.BuildingName).cheques),1),t[30]||(t[30]=(0,s.Lk)("div",{class:"text-xs text-gray-500"},"Cheques",-1))]),(0,s.Lk)("div",null,[(0,s.Lk)("div",qa,(0,r.v_)(l.formatCurrency(l.getBuildingStats(l.selectedBuilding.BuildingName).amount)),1),t[31]||(t[31]=(0,s.Lk)("div",{class:"text-xs text-gray-500"},"Total Amount",-1))])])])])])])])):(0,s.Q3)("",!0)])}const Ea={name:"Buildings",setup(){const e=(0,h.KR)(!1),t=(0,h.KR)([]),a=(0,h.KR)([]),l=(0,h.KR)([]),r=(0,h.KR)(null),n=(0,s.EW)(()=>a.value.length),i=(0,s.EW)(()=>l.value.length),o=(0,s.EW)(()=>l.value.reduce((e,t)=>e+(t.Amount||0),0)),d=async()=>{e.value=!0;try{const[e,s,r]=await Promise.all([me.A.get("/api/buildings"),me.A.get("/api/apartments"),me.A.get("/api/cheques/detail")]);t.value=e.data,a.value=s.data,l.value=r.data,console.log("Buildings - Buildings data:",e.data),console.log("Buildings - Apartments data:",s.data),console.log("Buildings - Cheques data:",r.data),console.log("Buildings - Sample building name:",e.data[0]?.BuildingName),console.log("Buildings - Sample apartment BuildingName:",s.data[0]?.BuildingName),console.log("Buildings - Sample cheque BuildingName:",r.data[0]?.BuildingName),s.data.length>0&&(console.log("Buildings - Sample apartment IsOccupied:",s.data[0]?.IsOccupied),console.log("Buildings - Sample apartment isOccupied:",s.data[0]?.isOccupied),console.log("Buildings - Apartments with IsOccupied true:",s.data.filter(e=>!0===e.IsOccupied||1===e.IsOccupied).length),console.log("Buildings - Apartments with IsOccupied false:",s.data.filter(e=>!1===e.IsOccupied||0===e.IsOccupied).length))}catch(s){console.error("Error fetching data:",s)}finally{e.value=!1}},c=e=>{console.log(`Buildings - Getting stats for BuildingName: ${e}`),console.log("Buildings - Available apartments:",a.value),console.log("Buildings - Available cheques:",l.value);const t=a.value.filter(t=>t.BuildingName===e||t.buildingName===e),s=l.value.filter(t=>t.BuildingName===e||t.buildingName===e),r=s.reduce((e,t)=>e+(t.Amount||0),0),n={apartments:t.length,cheques:s.length,amount:r};return console.log(`Buildings - Stats for BuildingName ${e}:`,n),console.log("Buildings - Found apartments:",t),console.log("Buildings - Found cheques:",s),n},u=e=>a.value.filter(t=>t.BuildingName===e||t.buildingName===e),m=e=>{const t=a.value.filter(t=>t.BuildingName===e||t.buildingName===e);if(0===t.length)return 0;const l=t.filter(e=>!0===e.IsOccupied||1===e.IsOccupied||!0===e.isOccupied||1===e.isOccupied),s=l.length/t.length*100;return console.log(`Buildings - Occupancy calculation for ${e}:`,{totalApartments:t.length,occupiedApartments:l.length,occupancyRate:Math.round(s)}),Math.round(s)},g=e=>{const t=a.value.filter(t=>t.BuildingName===e||t.buildingName===e);if(0===t.length)return 0;const l=t.filter(e=>!0===e.IsOccupied||1===e.IsOccupied||!0===e.isOccupied||1===e.isOccupied),s=l.length/t.length*100;return console.log(`Buildings - Recent occupancy calculation for ${e}:`,{totalApartments:t.length,recentlyOccupiedApartments:l.length,recentOccupancyRate:Math.round(s)}),Math.round(s)},p=e=>{const t=a.value.filter(t=>t.BuildingName===e||t.buildingName===e);if(0===t.length)return{total:0,occupied:0,vacant:0,rate:0};const l=t.filter(e=>!0===e.IsOccupied||1===e.IsOccupied||!0===e.isOccupied||1===e.isOccupied),s=t.filter(e=>!1===e.IsOccupied||0===e.IsOccupied||!1===e.isOccupied||0===e.isOccupied);return{total:t.length,occupied:l.length,vacant:s.length,rate:Math.round(l.length/t.length*100)}},v=e=>{r.value=e},k=async()=>{await d()},x=e=>new Intl.NumberFormat("en-AE",{style:"currency",currency:"AED"}).format(e||0);return(0,s.sV)(()=>{d()}),{loading:e,buildings:t,apartments:a,cheques:l,selectedBuilding:r,totalApartments:n,totalCheques:i,totalAmount:o,getBuildingStats:c,getBuildingApartments:u,getOccupancyRate:m,getRecentOccupancyRate:g,getOccupancyDetails:p,selectBuilding:v,refreshData:k,formatCurrency:x}}},Ia=(0,b.A)(Ea,[["render",Da]]),ja=Ia,_a={class:"space-y-6"},Ma={class:"sm:flex sm:items-center sm:justify-between"},Oa={class:"mt-4 sm:mt-0"},Fa=["disabled"],Ra={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Pa={key:1,class:"-ml-1 mr-2 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Sa={class:"card"},Va={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Xa=["value"],Ka={class:"mt-4 flex justify-end"},Wa=["disabled"],za={class:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4"},Ha={class:"card"},Ta={class:"flex items-center"},Ua={class:"ml-5 w-0 flex-1"},$a={class:"text-lg font-medium text-gray-900"},Ja={class:"card"},Qa={class:"flex items-center"},Ga={class:"ml-5 w-0 flex-1"},Ya={class:"text-lg font-medium text-gray-900"},Za={class:"card"},el={class:"flex items-center"},tl={class:"ml-5 w-0 flex-1"},al={class:"text-lg font-medium text-gray-900"},ll={class:"grid grid-cols-1 gap-6 lg:grid-cols-2 xl:grid-cols-3"},sl=["onClick"],rl={class:"flex items-center justify-between mb-4"},nl={class:"flex items-center"},il={class:"ml-3"},ol={class:"text-lg font-medium text-gray-900"},dl={class:"text-sm text-gray-500"},cl={class:"text-right"},ul={class:"text-2xl font-bold text-green-600"},ml={class:"border-t border-gray-100 pt-4"},gl={class:"grid grid-cols-2 gap-4 text-sm"},pl={class:"ml-2 font-medium text-gray-900"},vl={class:"ml-2 font-medium text-gray-900"},kl={class:"mt-4 pt-4 border-t border-gray-100"},xl={class:"flex items-center justify-between"},hl={class:"flex items-center space-x-2"},fl={class:"text-sm font-medium text-gray-900"},yl={class:"text-sm font-medium text-gray-900"},Ll={class:"flex items-center justify-between"},bl={class:"flex-1 flex justify-between sm:hidden"},wl=["disabled"],Al=["disabled"],Cl={class:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between"},Bl={class:"text-sm text-gray-700"},Nl={class:"font-medium"},ql={class:"font-medium"},Dl={class:"font-medium"},El={class:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px"},Il=["disabled"],jl=["disabled"],_l={key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},Ml={class:"relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white"},Ol={class:"mt-3"},Fl={class:"flex items-center justify-between mb-4"},Rl={class:"text-lg font-medium text-gray-900"},Pl={class:"space-y-4"},Sl={class:"grid grid-cols-2 gap-4"},Vl={class:"mt-1 text-sm text-gray-900"},Xl={class:"mt-1 text-sm text-gray-900"},Kl={class:"mt-1 text-sm text-gray-900"},Wl={class:"mt-1 text-sm text-gray-900"},zl={class:"border-t border-gray-200 pt-4"},Hl={class:"max-h-60 overflow-y-auto"},Tl={class:"text-sm font-medium text-gray-900"},Ul={class:"ml-2 text-xs text-gray-500"},$l={class:"text-sm font-medium text-gray-900"},Jl={key:0,class:"text-center py-4 text-gray-500"},Ql={class:"border-t border-gray-200 pt-4"},Gl={class:"grid grid-cols-2 gap-4 text-center"},Yl={class:"text-2xl font-bold text-green-600"},Zl={class:"text-2xl font-bold text-purple-600"};function es(e,t,a,n,i,o){return(0,s.uX)(),(0,s.CE)("div",_a,[(0,s.Lk)("div",Ma,[t[15]||(t[15]=(0,s.Lk)("div",null,[(0,s.Lk)("h1",{class:"text-3xl font-bold text-gray-900"},"Apartments Management"),(0,s.Lk)("p",{class:"mt-2 text-sm text-gray-700"}," View and manage all apartment information ")],-1)),(0,s.Lk)("div",Oa,[(0,s.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>n.refreshData&&n.refreshData(...e)),disabled:n.loading,class:"btn-primary inline-flex items-center"},[n.loading?((0,s.uX)(),(0,s.CE)("svg",Ra,[...t[12]||(t[12]=[(0,s.Lk)("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),(0,s.Lk)("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):((0,s.uX)(),(0,s.CE)("svg",Pa,[...t[13]||(t[13]=[(0,s.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])])),t[14]||(t[14]=(0,s.eW)(" Refresh ",-1))],8,Fa)])]),(0,s.Lk)("div",Sa,[t[19]||(t[19]=(0,s.Lk)("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Filters",-1)),(0,s.Lk)("div",Va,[(0,s.Lk)("div",null,[t[17]||(t[17]=(0,s.Lk)("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Building",-1)),(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>n.filters.buildingId=e),class:"input-field",onChange:t[2]||(t[2]=(...e)=>n.applyFilters&&n.applyFilters(...e))},[t[16]||(t[16]=(0,s.Lk)("option",{value:""},"All Buildings",-1)),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.buildings,e=>((0,s.uX)(),(0,s.CE)("option",{key:e.BuildingID,value:e.BuildingID},(0,r.v_)(e.BuildingName),9,Xa))),128))],544),[[l.u1,n.filters.buildingId]])]),(0,s.Lk)("div",null,[t[18]||(t[18]=(0,s.Lk)("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Search",-1)),(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=e=>n.filters.search=e),placeholder:"Search apartments...",class:"input-field",onInput:t[4]||(t[4]=(...e)=>n.applyFilters&&n.applyFilters(...e))},null,544),[[l.Jo,n.filters.search]])])]),(0,s.Lk)("div",Ka,[(0,s.Lk)("button",{onClick:t[5]||(t[5]=(...e)=>n.clearFilters&&n.clearFilters(...e)),class:"btn-secondary mr-2"}," Clear Filters "),(0,s.Lk)("button",{onClick:t[6]||(t[6]=(...e)=>n.applyFilters&&n.applyFilters(...e)),disabled:n.loading,class:"btn-primary"}," Apply Filters ",8,Wa)])]),(0,s.Lk)("div",za,[(0,s.Lk)("div",Ha,[(0,s.Lk)("div",Ta,[t[21]||(t[21]=(0,s.Fv)('<div class="flex-shrink-0"><div class="w-8 h-8 bg-primary-100 rounded-lg flex items-center justify-center"><svg class="w-5 h-5 text-primary-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5v4m8-4v4M8 11v4m8-4v4"></path></svg></div></div>',1)),(0,s.Lk)("div",Ua,[(0,s.Lk)("dl",null,[t[20]||(t[20]=(0,s.Lk)("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Total Apartments",-1)),(0,s.Lk)("dd",$a,(0,r.v_)(n.filteredApartments.length),1)])])])]),(0,s.Lk)("div",Ja,[(0,s.Lk)("div",Qa,[t[23]||(t[23]=(0,s.Lk)("div",{class:"flex-shrink-0"},[(0,s.Lk)("div",{class:"w-8 h-8 bg-yellow-100 rounded-lg flex items-center justify-center"},[(0,s.Lk)("svg",{class:"w-5 h-5 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,s.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])])],-1)),(0,s.Lk)("div",Ga,[(0,s.Lk)("dl",null,[t[22]||(t[22]=(0,s.Lk)("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Total Cheques",-1)),(0,s.Lk)("dd",Ya,(0,r.v_)(n.totalCheques),1)])])])]),(0,s.Lk)("div",Za,[(0,s.Lk)("div",el,[t[25]||(t[25]=(0,s.Lk)("div",{class:"flex-shrink-0"},[(0,s.Lk)("div",{class:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center"},[(0,s.Lk)("svg",{class:"w-5 h-5 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,s.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})])])],-1)),(0,s.Lk)("div",tl,[(0,s.Lk)("dl",null,[t[24]||(t[24]=(0,s.Lk)("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Total Amount",-1)),(0,s.Lk)("dd",al,(0,r.v_)(n.formatCurrency(n.totalAmount)),1)])])])])]),(0,s.Lk)("div",ll,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.paginatedApartments,e=>((0,s.uX)(),(0,s.CE)("div",{key:e.ApartmentID,class:"card hover:shadow-lg transition-shadow duration-200 cursor-pointer",onClick:t=>n.selectApartment(e)},[(0,s.Lk)("div",rl,[(0,s.Lk)("div",nl,[t[26]||(t[26]=(0,s.Lk)("div",{class:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center"},[(0,s.Lk)("svg",{class:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,s.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"}),(0,s.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 5v4m8-4v4M8 11v4m8-4v4"})])],-1)),(0,s.Lk)("div",il,[(0,s.Lk)("h3",ol,(0,r.v_)(e.ApartmentName),1),(0,s.Lk)("p",dl,(0,r.v_)(n.getBuildingName(e.BuildingID)),1)])]),(0,s.Lk)("div",cl,[(0,s.Lk)("div",ul,(0,r.v_)(e.FloorNumber),1),t[27]||(t[27]=(0,s.Lk)("div",{class:"text-xs text-gray-500"},"Floor",-1))])]),(0,s.Lk)("div",ml,[(0,s.Lk)("div",gl,[(0,s.Lk)("div",null,[t[28]||(t[28]=(0,s.Lk)("span",{class:"text-gray-500"},"Apartment #:",-1)),(0,s.Lk)("span",pl,(0,r.v_)(e.ApartmentNumber||"N/A"),1)]),(0,s.Lk)("div",null,[t[29]||(t[29]=(0,s.Lk)("span",{class:"text-gray-500"},"Building #:",-1)),(0,s.Lk)("span",vl,(0,r.v_)(e.BuildingNumber||"N/A"),1)])])]),(0,s.Lk)("div",kl,[(0,s.Lk)("div",xl,[t[31]||(t[31]=(0,s.Lk)("span",{class:"text-sm text-gray-500"},"Cheques",-1)),(0,s.Lk)("div",hl,[(0,s.Lk)("span",fl,(0,r.v_)(n.getApartmentCheques(e.ApartmentID).length),1),t[30]||(t[30]=(0,s.Lk)("span",{class:"text-xs text-gray-500"},"|",-1)),(0,s.Lk)("span",yl,(0,r.v_)(n.formatCurrency(n.getApartmentAmount(e.ApartmentID))),1)])])])],8,sl))),128))]),(0,s.Lk)("div",Ll,[(0,s.Lk)("div",bl,[(0,s.Lk)("button",{onClick:t[7]||(t[7]=(...e)=>n.previousPage&&n.previousPage(...e)),disabled:1===n.currentPage,class:"btn-secondary"}," Previous ",8,wl),(0,s.Lk)("button",{onClick:t[8]||(t[8]=(...e)=>n.nextPage&&n.nextPage(...e)),disabled:n.currentPage===n.totalPages,class:"btn-primary"}," Next ",8,Al)]),(0,s.Lk)("div",Cl,[(0,s.Lk)("div",null,[(0,s.Lk)("p",Bl,[t[32]||(t[32]=(0,s.eW)(" Showing ",-1)),(0,s.Lk)("span",Nl,(0,r.v_)(n.startIndex+1),1),t[33]||(t[33]=(0,s.eW)(" to ",-1)),(0,s.Lk)("span",ql,(0,r.v_)(n.endIndex),1),t[34]||(t[34]=(0,s.eW)(" of ",-1)),(0,s.Lk)("span",Dl,(0,r.v_)(n.filteredApartments.length),1),t[35]||(t[35]=(0,s.eW)(" results ",-1))])]),(0,s.Lk)("div",null,[(0,s.Lk)("nav",El,[(0,s.Lk)("button",{onClick:t[9]||(t[9]=(...e)=>n.previousPage&&n.previousPage(...e)),disabled:1===n.currentPage,class:"btn-secondary rounded-l-md"}," Previous ",8,Il),(0,s.Lk)("button",{onClick:t[10]||(t[10]=(...e)=>n.nextPage&&n.nextPage(...e)),disabled:n.currentPage===n.totalPages,class:"btn-primary rounded-r-md"}," Next ",8,jl)])])])]),n.selectedApartment?((0,s.uX)(),(0,s.CE)("div",_l,[(0,s.Lk)("div",Ml,[(0,s.Lk)("div",Ol,[(0,s.Lk)("div",Fl,[(0,s.Lk)("h3",Rl,(0,r.v_)(n.selectedApartment.ApartmentName)+" Details ",1),(0,s.Lk)("button",{onClick:t[11]||(t[11]=e=>n.selectedApartment=null),class:"text-gray-400 hover:text-gray-600"},[...t[36]||(t[36]=[(0,s.Lk)("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,s.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),(0,s.Lk)("div",Pl,[(0,s.Lk)("div",Sl,[(0,s.Lk)("div",null,[t[37]||(t[37]=(0,s.Lk)("label",{class:"block text-sm font-medium text-gray-700"},"Apartment Name",-1)),(0,s.Lk)("p",Vl,(0,r.v_)(n.selectedApartment.ApartmentName),1)]),(0,s.Lk)("div",null,[t[38]||(t[38]=(0,s.Lk)("label",{class:"block text-sm font-medium text-gray-700"},"Apartment Number",-1)),(0,s.Lk)("p",Xl,(0,r.v_)(n.selectedApartment.ApartmentNumber||"N/A"),1)]),(0,s.Lk)("div",null,[t[39]||(t[39]=(0,s.Lk)("label",{class:"block text-sm font-medium text-gray-700"},"Floor Number",-1)),(0,s.Lk)("p",Kl,(0,r.v_)(n.selectedApartment.FloorNumber),1)]),(0,s.Lk)("div",null,[t[40]||(t[40]=(0,s.Lk)("label",{class:"block text-sm font-medium text-gray-700"},"Building",-1)),(0,s.Lk)("p",Wl,(0,r.v_)(n.getBuildingName(n.selectedApartment.BuildingID)),1)])]),(0,s.Lk)("div",zl,[t[41]||(t[41]=(0,s.Lk)("h4",{class:"text-md font-medium text-gray-900 mb-3"},"Cheques History",-1)),(0,s.Lk)("div",Hl,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.getApartmentCheques(n.selectedApartment.ApartmentID),e=>((0,s.uX)(),(0,s.CE)("div",{key:e.ChequeID,class:"flex items-center justify-between py-2 border-b border-gray-100 last:border-b-0"},[(0,s.Lk)("div",null,[(0,s.Lk)("span",Tl,(0,r.v_)(e.ChequeNo),1),(0,s.Lk)("span",Ul,(0,r.v_)(n.formatDate(e.ChequeDate)),1)]),(0,s.Lk)("span",$l,(0,r.v_)(n.formatCurrency(e.Amount)),1)]))),128)),0===n.getApartmentCheques(n.selectedApartment.ApartmentID).length?((0,s.uX)(),(0,s.CE)("div",Jl," No cheques found for this apartment ")):(0,s.Q3)("",!0)])]),(0,s.Lk)("div",Ql,[t[44]||(t[44]=(0,s.Lk)("h4",{class:"text-md font-medium text-gray-900 mb-3"},"Financial Summary",-1)),(0,s.Lk)("div",Gl,[(0,s.Lk)("div",null,[(0,s.Lk)("div",Yl,(0,r.v_)(n.getApartmentCheques(n.selectedApartment.ApartmentID).length),1),t[42]||(t[42]=(0,s.Lk)("div",{class:"text-xs text-gray-500"},"Total Cheques",-1))]),(0,s.Lk)("div",null,[(0,s.Lk)("div",Zl,(0,r.v_)(n.formatCurrency(n.getApartmentAmount(n.selectedApartment.ApartmentID))),1),t[43]||(t[43]=(0,s.Lk)("div",{class:"text-xs text-gray-500"},"Total Amount",-1))])])])])])])])):(0,s.Q3)("",!0)])}const ts={name:"Apartments",setup(){const e=(0,h.KR)(!1),t=(0,h.KR)([]),a=(0,h.KR)([]),l=(0,h.KR)([]),r=(0,h.KR)(null),n=(0,h.KR)({buildingId:"",search:""}),i=(0,h.KR)(1),o=12,d=(0,s.EW)(()=>{let e=t.value;if(n.value.search){const t=n.value.search.toLowerCase();e=e.filter(e=>e.ApartmentName?.toLowerCase().includes(t)||e.ApartmentNumber?.toLowerCase().includes(t)||B(e.BuildingID)?.toLowerCase().includes(t))}return e}),c=(0,s.EW)(()=>{const e=(i.value-1)*o,t=e+o;return d.value.slice(e,t)}),u=(0,s.EW)(()=>Math.ceil(d.value.length/o)),m=(0,s.EW)(()=>(i.value-1)*o),g=(0,s.EW)(()=>Math.min(m.value+o,d.value.length)),p=(0,s.EW)(()=>{const e=new Set(d.value.map(e=>e.ApartmentID));return l.value.filter(t=>e.has(t.ApartmentID)).length}),v=(0,s.EW)(()=>{const e=new Set(d.value.map(e=>e.ApartmentID));return l.value.filter(t=>e.has(t.ApartmentID)).reduce((e,t)=>e+(t.Amount||0),0)}),k=async()=>{e.value=!0;try{const[e,t]=await Promise.all([me.A.get("/api/buildings"),me.A.get("/api/cheques/detail")]);a.value=e.data,l.value=t.data,await x()}catch(t){console.error("Error fetching data:",t)}finally{e.value=!1}},x=async()=>{try{const e={};n.value.buildingId&&(e.buildingId=n.value.buildingId);const a=await me.A.get("/api/apartments",{params:e});t.value=a.data}catch(e){console.error("Error fetching apartments:",e)}},f=()=>{i.value=1,x()},L=()=>{n.value={buildingId:"",search:""},i.value=1,x()},b=()=>{i.value>1&&i.value--},w=()=>{i.value<u.value&&i.value++},A=e=>{r.value=e},C=async()=>{await k(),await x()},B=e=>{const t=a.value.find(t=>t.BuildingID===e);return t?t.BuildingName:"Unknown Building"},N=e=>{const t=a.value.find(t=>t.BuildingID===e);return t?t.BuildingNumber:null},q=e=>l.value.filter(t=>t.ApartmentID===e),D=e=>{const t=q(e);return t.reduce((e,t)=>e+(t.Amount||0),0)},E=e=>new Intl.NumberFormat("en-AE",{style:"currency",currency:"AED"}).format(e||0),I=e=>{try{return(0,y.A)((0,ge.A)(e),"MMM dd, yyyy")}catch{return e}};return(0,s.sV)(async()=>{await k()}),(0,s.wB)(n,(e,t)=>{i.value=1,e.buildingId!==t?.buildingId&&x()}),{loading:e,apartments:t,buildings:a,cheques:l,selectedApartment:r,filters:n,currentPage:i,totalPages:u,startIndex:m,endIndex:g,filteredApartments:d,paginatedApartments:c,totalCheques:p,totalAmount:v,applyFilters:f,clearFilters:L,previousPage:b,nextPage:w,selectApartment:A,refreshData:C,getBuildingName:B,getBuildingNumber:N,getApartmentCheques:q,getApartmentAmount:D,fetchApartments:x,formatCurrency:E,formatDate:I}}},as=(0,b.A)(ts,[["render",es]]),ls=as,ss={class:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8"},rs={class:"max-w-md w-full space-y-8"},ns={class:"rounded-md shadow-sm -space-y-px"},is=["disabled"],os=["disabled"],ds={key:0,class:"rounded-md bg-red-50 p-4"},cs={class:"flex"},us={class:"ml-3"},ms={class:"text-sm font-medium text-red-800"},gs=["disabled"],ps={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},vs={key:1,class:"-ml-1 mr-2 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"};function ks(e,t,a,n,i,o){return(0,s.uX)(),(0,s.CE)("div",ss,[(0,s.Lk)("div",rs,[t[8]||(t[8]=(0,s.Fv)('<div><div class="mx-auto h-12 w-12 bg-primary-600 rounded-lg flex items-center justify-center"><svg class="h-8 w-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path></svg></div><h2 class="mt-6 text-center text-3xl font-extrabold text-gray-900"> V2R Cheques Management </h2><p class="mt-2 text-center text-sm text-gray-600"> Sign in to access your dashboard </p></div>',1)),(0,s.Lk)("form",{class:"mt-8 space-y-6",onSubmit:t[2]||(t[2]=(0,l.D$)((...e)=>n.handleLogin&&n.handleLogin(...e),["prevent"]))},[(0,s.Lk)("div",ns,[(0,s.Lk)("div",null,[t[3]||(t[3]=(0,s.Lk)("label",{for:"username",class:"sr-only"},"Username",-1)),(0,s.bo)((0,s.Lk)("input",{id:"username","onUpdate:modelValue":t[0]||(t[0]=e=>n.credentials.username=e),name:"username",type:"text",required:"",class:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-primary-500 focus:border-primary-500 focus:z-10 sm:text-sm",placeholder:"Username",disabled:n.loading},null,8,is),[[l.Jo,n.credentials.username]])]),(0,s.Lk)("div",null,[t[4]||(t[4]=(0,s.Lk)("label",{for:"password",class:"sr-only"},"Password",-1)),(0,s.bo)((0,s.Lk)("input",{id:"password","onUpdate:modelValue":t[1]||(t[1]=e=>n.credentials.password=e),name:"password",type:"password",required:"",class:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-primary-500 focus:border-primary-500 focus:z-10 sm:text-sm",placeholder:"Password",disabled:n.loading},null,8,os),[[l.Jo,n.credentials.password]])])]),n.error?((0,s.uX)(),(0,s.CE)("div",ds,[(0,s.Lk)("div",cs,[t[5]||(t[5]=(0,s.Lk)("div",{class:"flex-shrink-0"},[(0,s.Lk)("svg",{class:"h-5 w-5 text-red-400",fill:"currentColor",viewBox:"0 0 20 20"},[(0,s.Lk)("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),(0,s.Lk)("div",us,[(0,s.Lk)("h3",ms,(0,r.v_)(n.error),1)])])])):(0,s.Q3)("",!0),(0,s.Lk)("div",null,[(0,s.Lk)("button",{type:"submit",disabled:n.loading,class:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed"},[n.loading?((0,s.uX)(),(0,s.CE)("svg",ps,[...t[6]||(t[6]=[(0,s.Lk)("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),(0,s.Lk)("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):((0,s.uX)(),(0,s.CE)("svg",vs,[...t[7]||(t[7]=[(0,s.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"},null,-1)])])),(0,s.eW)(" "+(0,r.v_)(n.loading?"Signing in...":"Sign in"),1)],8,gs)])],32)])])}const xs={name:"Login",setup(){const e=(0,f.rd)(),t=(0,h.KR)(!1),a=(0,h.KR)(""),l=(0,h.Kh)({username:"",password:""}),s=async()=>{t.value=!0,a.value="";try{console.log("Sending credentials:",l),console.log("Credentials type:",typeof l),console.log("Stringified:",JSON.stringify(l));const t=await me.A.post("/api/auth/login",l,{headers:{"Content-Type":"application/json"}});t.data.success?(localStorage.setItem("isAuthenticated","true"),localStorage.setItem("user",JSON.stringify(t.data.user)),e.push("/")):a.value=t.data.message||"Invalid credentials"}catch(s){console.error("Login error:",s),console.error("Error response:",s.response),a.value=s.response?.data?.message||"An error occurred during login"}finally{t.value=!1}};return{credentials:l,loading:t,error:a,handleLogin:s}}},hs=(0,b.A)(xs,[["render",ks]]),fs=hs,ys=[{path:"/login",name:"Login",component:fs},{path:"/",name:"Dashboard",component:ke,meta:{requiresAuth:!0}},{path:"/cheques",name:"ChequesDetail",component:pt,meta:{requiresAuth:!0}},{path:"/buildings",name:"Buildings",component:ja,meta:{requiresAuth:!0}},{path:"/apartments",name:"Apartments",component:ls,meta:{requiresAuth:!0}},{path:"/:pathMatch(.*)*",redirect:"/login"}],Ls=(0,f.aE)({history:(0,f.LA)("/"),routes:ys});Ls.beforeEach((e,t,a)=>{const l="true"===localStorage.getItem("isAuthenticated");e.meta.requiresAuth&&!l?a("/login"):"/login"===e.path&&l?a("/"):"/"!==e.path||l?a():a("/login")});const bs=Ls;"hamdan.v2r.systems"===window.location.hostname&&(me.A.defaults.baseURL="https://system.v2r.ae",console.log(" Using production API:",me.A.defaults.baseURL));const ws=(0,l.Ef)(A);ws.use(bs),ws.mount("#app")}},t={};function a(l){var s=t[l];if(void 0!==s)return s.exports;var r=t[l]={exports:{}};return e[l](r,r.exports,a),r.exports}a.m=e,(()=>{var e=[];a.O=(t,l,s,r)=>{if(!l){var n=1/0;for(c=0;c<e.length;c++){for(var[l,s,r]=e[c],i=!0,o=0;o<l.length;o++)(!1&r||n>=r)&&Object.keys(a.O).every(e=>a.O[e](l[o]))?l.splice(o--,1):(i=!1,r<n&&(n=r));if(i){e.splice(c--,1);var d=s();void 0!==d&&(t=d)}}return t}r=r||0;for(var c=e.length;c>0&&e[c-1][2]>r;c--)e[c]=e[c-1];e[c]=[l,s,r]}})(),(()=>{a.d=(e,t)=>{for(var l in t)a.o(t,l)&&!a.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})}})(),(()=>{a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{a.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})(),(()=>{var e={524:0};a.O.j=t=>0===e[t];var t=(t,l)=>{var s,r,[n,i,o]=l,d=0;if(n.some(t=>0!==e[t])){for(s in i)a.o(i,s)&&(a.m[s]=i[s]);if(o)var c=o(a)}for(t&&t(l);d<n.length;d++)r=n[d],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(c)},l=self["webpackChunkv2r_dashboard_client"]=self["webpackChunkv2r_dashboard_client"]||[];l.forEach(t.bind(null,0)),l.push=t.bind(null,l.push.bind(l))})();var l=a.O(void 0,[504],()=>a(855));l=a.O(l)})();
//# sourceMappingURL=app.4884f16a.js.map